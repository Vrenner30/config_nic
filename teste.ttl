; ============================================================
; AUTOMAÇÃO NIC - VERSÃO OTIMIZADA MODULAR
; ============================================================

; --- 1. CONFIGURAÇÃO DO MENU ---
strdim estados 4
estados[0] = 'Mato Grosso (Energisa)'
estados[1] = 'Sao Paulo (Exemplo)'
estados[2] = 'Rio de Janeiro (Exemplo)'
estados[3] = 'Sair'

listbox 'Selecione o estado para configurar:' 'Automacao NIC' estados

if result = -1 end
choice = result

; Se escolher Sair (o último item)
if choice = 3 then
    end
endif

; --- 2. ROTINA DE ACORDAR (Chamada Global) ---
call :WakeUpDevice

; --- 3. SELEÇÃO DA BIBLIOTECA (Lógica de Decisão) ---
; Aqui apenas direcionamos para o bloco de comandos correto
if choice = 0 then
    call :Config_MatoGrosso
elseif choice = 1 then
    call :Config_SaoPaulo
elseif choice = 2 then
    call :Config_RioJaneiro
endif

; --- 4. SALVAR E REINICIAR (Chamada Global) ---
call :SaveAndRestart

end
; ============================================================
; FIM DO FLUXO PRINCIPAL - ABAIXO FICAM AS SUBROTINAS
; ============================================================

; ------------------------------------------------------------
; SUBROTINA: ACORDAR EQUIPAMENTO
; ------------------------------------------------------------
:WakeUpDevice
    messagebox 'Certifique-se que o cursor esta na janela do Tera Term.' 'Iniciando'
    send '@@@'
    pause 1
    sendln ''
    pause 1
    return

; ------------------------------------------------------------
; SUBROTINA: CONFIGURAÇÃO MATO GROSSO
; ------------------------------------------------------------
:Config_MatoGrosso
    sendln '$userdef,----,ENERGISA MT,00000000'
    pause 1
    sendln '$simlib,1,ENERGISA.CLARO.COM.BR,10.200.1.204,40001,0,rs2000,rs2000,895505'
    pause 1
    sendln '$simlib,2,TIM.BR,191.6.4.114,40001,0,rs2000,rs2000,895502'
    pause 1
    sendln '$simlib,3,smart.m2m.vivo.com.br,191.6.4.114,40001,1,vivo,vivo,895506'
    pause 1
    sendln '$simlib,4,gprs.oi.com.br,191.6.4.114,40001,0,rs2000,rs2000,895531'
    pause 1
    sendln '$simlib,5,zap.vivo.com.br,191.6.4.114,40001,1,vivo,vivo,895511'
    pause 1
    sendln '$simlib,6,zap.vivo.com.br,191.6.4.114,40001,1,vivo,vivo,895523'
    pause 1
    sendln '$protocols,1,11,99,0,1'
    pause 1
    sendln '$CHANNELS,1,6'
    pause 1
    sendln '$scheds,1,6,31,0,86400'
    pause 1
    sendln '$scheds,1,3,10,0,900'
    pause 1
    sendln '$scheds,1,4,93,0,600'
    pause 1
    sendln '$scheds,1,7,30,01112025000000,1'
    pause 1
    return

; ------------------------------------------------------------
; SUBROTINA: CONFIGURAÇÃO SAO PAULO (EXEMPLO)
; ------------------------------------------------------------
:Config_SaoPaulo
    sendln '$userdef,----,CLIENTE SP,00000000'
    pause 1
    sendln '$simlib,1,APN.SP.COM.BR,10.0.0.1,40001,0,user,pass,12345'
    pause 1
    ; Adicione aqui os comandos específicos de SP
    return

; ------------------------------------------------------------
; SUBROTINA: CONFIGURAÇÃO RIO DE JANEIRO (EXEMPLO)
; ------------------------------------------------------------
:Config_RioJaneiro
    sendln '$userdef,----,CLIENTE RJ,00000000'
    pause 1
    sendln '$simlib,1,APN.RJ.COM.BR,10.0.0.2,40001,0,user,pass,67890'
    pause 1
    ; Adicione aqui os comandos específicos do RJ
    return

; ------------------------------------------------------------
; SUBROTINA: SALVAR, REINICIAR E VERIFICAR
; ------------------------------------------------------------
:SaveAndRestart
    sendln '$save'
    pause 5
    sendln '$restart'
    
    messagebox 'O equipamento esta reiniciando. Aguarde a verificacao automatica (40s).' 'Aguarde'
    pause 41
    
    ; Re-acorda o equipamento
    send '@@@'
    pause 1
    sendln ''
    
    ; Verificação
    sendln '$vers'
    pause 1
    sendln '$gsimlib'
    messagebox 'Processo Finalizado! Verifique as respostas na tela.' 'Concluido'
    return